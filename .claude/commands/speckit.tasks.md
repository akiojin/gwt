---
description: 利用可能な設計成果物に基づいて、実行可能で依存関係を考慮したtasks.mdを生成します。
---

## ユーザー入力

```text
$ARGUMENTS
```

追加の指示があれば必ず反映します。

## 手順概要

1. **対象SPEC IDの決定（必須）**:
   - ユーザー入力に `SPEC-[a-f0-9]{8}` が含まれる場合、それを対象SPEC IDとします。
   - 含まれない場合は `specs/specs.md` を提示し、ユーザーに対象SPEC IDを選んでもらってください（このコマンドはそこで停止）。

2. **前提確認（JSON取得）**:
   - リポジトリルートで以下を実行し、JSON をパースして `FEATURE_DIR` / `AVAILABLE_DOCS` / `SPEC_ID` を取得します。
     - `.specify/scripts/bash/check-prerequisites.sh --json --spec-id <SPEC_ID>`

3. **設計資料の読込**（`FEATURE_DIR` 配下）:
   - 必須: `plan.md`（技術スタック・構造）、`spec.md`（ユーザーストーリーと優先度）
   - 任意: `data-model.md`、`contracts/`、`research.md`、`quickstart.md`

4. **tasks.md の生成**:
   - `.specify/templates/tasks-template.md` をベースにフェーズ構成を維持して埋めます。
   - フェーズ1: セットアップ（プロジェクト初期化）
   - フェーズ2: 基盤（全ストーリー共通の基盤）
   - フェーズ3以降: ストーリー毎に 1 フェーズ（spec.md の優先度順）
   - 最終フェーズ: 仕上げ・横断事項

5. **タスク書式（必須）**:
   - すべてのタスクは次の形式に従ってください。
     ```text
     - [ ] T001 [P] [US1] 説明 .../path/to/file
     ```
     - `- [ ]` のチェックボックス
     - `T001` の連番ID
     - 並列可能なら `[P]`
     - ストーリーフェーズでは `[USn]` を必須付与
     - 具体的なファイルパスを含める

6. **テストタスク**:
   - TDD やテスト要求が `spec.md` に明示されている場合のみ作成します。
   - 各ストーリーの実装タスクより前に配置します。

7. **依存関係と並列性**:
   - フェーズ冒頭でストーリー間の依存関係を一覧化します。
   - 並列可能なタスクには `[P]` を付け、同一ファイルを触るタスクは直列にします。

8. **要約レポート**:
   - `tasks.md` のパス
   - 総タスク数とフェーズ別内訳
   - 各ストーリーの独立テスト条件
   - 並列実行候補の有無
   - 推奨 MVP 範囲（通常は最初のストーリー）

## 追加指針

- タスクは LLM が追加情報なく実行できる粒度にします（1タスク1アクション）。
- 必要に応じて `/speckit.plan` や `/speckit.clarify` の再実行を提案してください。
