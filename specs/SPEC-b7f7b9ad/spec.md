# 機能仕様: gwt メニューショートカットと終了保護

**仕様ID**: `SPEC-b7f7b9ad`
**作成日**: 2026-02-13
**ステータス**: ドラフト
**カテゴリ**: GUI
**依存仕様**: `SPEC-4470704f`（Native メニュー）, `SPEC-dfb1611a`（トレイ常駐と終了制御）
**入力**: ユーザー説明: "Cmd+Q が終了してしまう、Cmd+C/V が自然に動かない"

## 機能要件

- **FR-101**: `Cmd+Q`（macOS）で `trap` される終了要求時、アプリ本体は即時終了せず、実行中エージェントがある場合は確認を出して `Close` のみ可能にする。
- **FR-102**: エージェント未実行時、`Cmd+Q` はアプリを終了せず、対象ウィンドウを非表示（hide）し継続稼働する。
- **FR-103**: ネイティブ Edit メニュー `Copy/Paste` は、キーボードショートカットからと同様に、現在アクティブなターミナル pane に対して直接コピー/ペーストを実行する。
- **FR-104**: `Cmd/Ctrl + C` は、端末選択文字列がある場合は `copy` を、ない場合は既存の中断送信（`0x03`）に影響しない既存動作を維持しつつ、意図しない OS デフォルト挙動を阻害しない。
- **FR-105**: `Cmd/Ctrl + V`（および既存条件）時、ペースト内容を端末入力として送信する。

## ユーザーストーリー

- **US-101**: 開発者として、ターミナルで重要な操作中でも `Cmd+Q` で誤終了しない。
- **US-102**: 開発者として、ネイティブメニューの Copy/Paste で端末操作をマウスなしで実行できる。

## 受け入れシナリオ

1. **前提条件** 実行中エージェントあり、**操作** macOS の `Cmd+Q`、**期待結果** 確認ダイアログが表示され、Cancel で継続、Close でウィンドウ非表示。
2. **前提条件** エージェント未実行、**操作** `Cmd+Q`、**期待結果** アプリは終了せずウィンドウが非表示。
3. **前提条件** ターミナルで文字を選択、**操作** メニュー `Edit > Copy` または `Cmd/Ctrl + C`、**期待結果** 選択文字がクリップボードに入る。
4. **前提条件** クリップボードに文字、**操作** メニュー `Edit > Paste` または `Cmd/Ctrl + V`、**期待結果** 文字が端末へ貼り付け。

## 制約

- UI文言は英語。
- 既存のカット/ペースト関連のショートカット競合（`Cut`/`Select All`）を破壊しない。
- フロント/バックのイベント名は既存の `menu-action` と `terminal-output` を流用。
